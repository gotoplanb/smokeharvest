# Add this to your project's CLAUDE.md file
# (or create CLAUDE.md at project root if it doesn't exist)
# ---

## Smoke Testing with SmokeHarvest

This project uses SmokeHarvest for automated smoke testing and test self-healing.
Documentation and prompts live in `./smokeharvest/`.

### Key files

- `smokeharvest/docs/` — Guides for auth, visual diffing, and health checks
- `smokeharvest/templates/prompts/initial-crawl.md` — Generate baseline tests from the live app
- `smokeharvest/templates/prompts/diff-and-report.md` — Detect changes after releases
- `smokeharvest/templates/prompts/self-heal.md` — Fix failing tests by exploring the live app
- `smokeharvest/scripts/diff_screenshots.py` — Visual diff utility for screenshot comparison

### Before updating tests

Always read `smokeharvest/docs/explore-health-checks.md` before auto-generating or
self-healing tests. Do not generate baselines from a broken app.

### Screenshot structure

Each run produces a single timestamped folder with everything together:

```
screenshots/20260129-181436/
├── explore/      <- MCP browser screenshots (NN-description.png)
├── script/       <- Playwright test screenshots (NN-description.png)
├── diff/         <- pixel difference images (generated by diff script)
└── report.md     <- verdict: ALL CLEAR / REVIEW NEEDED / SCRIPTS NEED UPDATE
```

See `smokeharvest/docs/visual-diffing.md` for details on folder setup, Docker
screenshot copying, scripted test configuration, and RMS thresholds.

### Running smoke tests

```bash
# Generate baseline (first time)
claude "Read smokeharvest/templates/prompts/initial-crawl.md and execute it against my app"

# After a release, check for changes
claude "Read smokeharvest/templates/prompts/diff-and-report.md and execute it"

# Fix failing tests
claude "Read smokeharvest/templates/prompts/self-heal.md and execute it. My app runs at http://localhost:PORT. Failing tests are in tests/"
```
